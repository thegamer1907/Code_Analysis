<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<!-- Generated by shtmldiff.py 1.2 -->
<title>Diff: 774269903_TLE.cpp - 774269903_A.cpp</title>
<style>
  body    { margin: 0.4ex; margin-right: auto; }
  table.diff   { border:0px; border-collapse:collapse;}
  table.diff tr { }
  table.diff td { padding: 0; white-space: pre; font-family: monospace; vertical-align: top; font-size: 0.86em;}
  table.diff th { padding: 0; font-size: 0.86em; }
  .diff .left   { background-color: #EEE; }
  .diff .right  { background-color: #FFF; }
  .diff .lblock { background-color: #BFB; }
  .diff .rblock { background-color: #FF8; }
  .diff .insert { background-color: #8FF; }
  .diff .delete { background-color: #ACF; }
  .diff .title  { background-color: orange; }
  .diff .skip   { background-color: lightgray; font-size: 0.9em; }
  .diff .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; }
  .diff .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; }
</style>
</head>
<body>
  <table class="diff">
<p> Time Diff : 0:34:41 <br></p>    <tr class="title"><th></th><th>&nbsp;774269903_TLE.cpp&nbsp;</th><th>&nbsp;</th><th>&nbsp;774269903_A.cpp&nbsp;</th><th></th></tr>
    <tr><td class="lineno">1</td><td class="left">#include&lt;bits/stdc++.h&gt;</td><td>&nbsp;</td><td class="right">#include&lt;bits/stdc++.h&gt;</td><td class="lineno">1</td></tr>
    <tr><td class="lineno">&nbsp;</td><td class="lblock">&nbsp;</td><td>&nbsp;</td><td class="rblock"><span class="insert">#define LL long long </span></td><td class="lineno">2</td></tr>
    <tr><td class="lineno">2</td><td class="left">#define maxn 200010</td><td>&nbsp;</td><td class="right">#define maxn 200010</td><td class="lineno">3</td></tr>
    <tr><td class="lineno">3</td><td class="lblock">#define <span class='delete'>LL long long</span></td><td>&nbsp;</td><td class="rblock">#define <span class='insert'>rep(i,a,b) for (int i=(a); i&lt;=(b); i++)</span></td><td class="lineno">4</td></tr>
    <tr><td class="lineno">4</td><td class="lblock">#define <span class='delete'>inf 2147483647</span></td><td>&nbsp;</td><td class="rblock">#define <span class='insert'>per(i,a,b) for (int i=(a); i&gt;=(b); i--)</span></td><td class="lineno">5</td></tr>
    <tr><td class="lineno">5</td><td class="left">using namespace std;</td><td>&nbsp;</td><td class="right">using namespace std;</td><td class="lineno">6</td></tr>
    <tr><td class="lineno">6</td><td class="lblock"><span class='delete'>int sum;</span></td><td>&nbsp;</td><td class="rblock">struct node{int <span class='insert'>x,y;}a[maxn];</span></td><td class="lineno">7</td></tr>
    <tr><td class="lineno">7</td><td class="lblock">struct node{int <span class='delete'>l,r,z,c,si,s;}a[maxn];</span></td><td>&nbsp;</td><td class="rblock">bool <span class='insert'>bk(node a1,node a2){</span></td><td class="lineno">8</td></tr>
    <tr><td class="lineno">8</td><td class="lblock"><span class='delete'>int _new(int x){a[++sum].z=x;a[sum].s=rand();a[sum].c=a[sum].si=1;return sum;}</span></td><td>&nbsp;</td><td class="rblock"><span class='insert'>        if(a1.y==a2.y)return a1.x&lt;a2.x;</span></td><td class="lineno">9</td></tr>
    <tr><td class="lineno">9</td><td class="lblock"><span class='delete'>void update(int x){a[x].si=a[a[x].l].si+a[a[x].r].si+a[x].c;return;}</span></td><td>&nbsp;</td><td class="rblock"><span class='insert'>        return a1.y&gt;a2.y;</span></td><td class="lineno">10</td></tr>
    <tr><td class="lineno">10</td><td class="lblock"><span class='delete'>void build(int &amp;root){root=_new(-inf);a[root].r=_new(inf);update(root);return;}</span></td><td>&nbsp;</td><td class="rblock"><span class='insert'>}</span></td><td class="lineno">11</td></tr>
    <tr><td class="lineno">11</td><td class="lblock"><span class='delete'>void zig(int &amp;p){int q=a[p].l;a[p].l=a[q].r;a[q].r=p;p=q;update(a[p].r);update(p);return;}</span></td><td>&nbsp;</td><td class="rblock"><span class='insert'>int n,su,fz[maxn],used[maxn];</span></td><td class="lineno">12</td></tr>
    <tr><td class="lineno">12</td><td class="lblock"><span class='delete'>void zag(int &amp;p){int q=a[p].r;a[p].r=a[q].l;a[q].l=p;p=q;update(a[p].l);update(p);return;}</span></td><td>&nbsp;</td><td class="rblock"><span class='insert'>int find(int x){return lower_bound(fz+1,fz+su+1,x)-fz;}</span></td><td class="lineno">13</td></tr>
    <tr><td class="lineno">13</td><td class="lblock"><span class='delete'>void insert(int &amp;p,int x){if(p==0){p=_new(x);return;}if(a[p].z==x){a[p].c++;update(p);return;}if(x&lt;a[p].z){insert(a[p].l,x);if(a[a[p].l].s&gt;a[p].s)zig(p);}else{insert(a[p].r,x);if(a[a[p].r].s&gt;a[p].s)zag(p);}update(p);return;}</span></td><td>&nbsp;</td><td class="rblock"><span class='insert'>int sum[maxn];</span></td><td class="lineno">14</td></tr>
    <tr><td class="lineno">14</td><td class="lblock"><span class='delete'>void remove(int &amp;p,int x){if(p==0)return;if(a[p].z==x){if(a[p].c&gt;1)a[p].c--;else{if(a[p].l||a[p].r){if(a[p].r==0&amp;&amp;a[a[p].l].s&gt;=a[a[p].r].s)zig(p),remove(a[p].r,x);else zag(p),remove(a[p].l,x);}else p=0;}update(p);return;}if(x&lt;a[p].z)remove(a[p].l,x);else remove(a[p].r,x);update(p);return;}</span></td><td>&nbsp;</td><td class="rblock"><span class='insert'>void add(int x){while(x&lt;=su)sum[x]++,x+=x&amp;(-x);return;}</span></td><td class="lineno">15</td></tr>
    <tr><td class="lineno">15</td><td class="lblock"><span class='delete'>int getrank(int p,int x){if(p==0)return 0;if(a[p].z==x)return a[a[p].l].si;if(x&lt;a[p].z)return getrank(a[p].l,x);return a[a[p].l].si+a[p].c+getrank(a[p].r,x);}</span></td><td>&nbsp;</td><td class="rblock"><span class='insert'>int query(int x){int ret=0;while(x&gt;0)ret+=sum[x],x-=x&amp;(-x);return ret;}</span></td><td class="lineno">16</td></tr>
    <tr><td class="lineno">16</td><td class="lblock"><span class='delete'>int n,root,rk[maxn];</span></td><td>&nbsp;</td><td class="rblock">int <span class='insert'>main() {</span></td><td class="lineno">17</td></tr>
    <tr><td class="lineno">17</td><td class="lblock"><span class='delete'>int mp[maxn];</span></td><td>&nbsp;</td><td class="rblock">&nbsp;</td><td class="lineno">&nbsp;</td></tr>
    <tr><td class="lineno">18</td><td class="lblock"><span class='delete'>LL ans;</span></td><td>&nbsp;</td><td class="rblock">&nbsp;</td><td class="lineno">&nbsp;</td></tr>
    <tr><td class="lineno">19</td><td class="lblock"><span class='delete'>struct hs{int x,y;}d[maxn];</span></td><td>&nbsp;</td><td class="rblock">&nbsp;</td><td class="lineno">&nbsp;</td></tr>
    <tr><td class="lineno">20</td><td class="lblock"><span class='delete'>bool bk(hs a1,hs a2){return a1.y&lt;a2.y;}</span></td><td>&nbsp;</td><td class="rblock">&nbsp;</td><td class="lineno">&nbsp;</td></tr>
    <tr><td class="lineno">21</td><td class="lblock">bool <span class='delete'>op(hs a1,hs a2){return a1.x&lt;a2.x;}</span></td><td>&nbsp;</td><td class="rblock">&nbsp;</td><td class="lineno">&nbsp;</td></tr>
    <tr><td class="lineno">22</td><td class="lblock">int <span class='delete'>main(){</span></td><td>&nbsp;</td><td class="rblock">&nbsp;</td><td class="lineno">&nbsp;</td></tr>
    <tr><td class="lineno">23</td><td class="left">        //freopen("Tokitsukaze.in","r",stdin);</td><td>&nbsp;</td><td class="right">        //freopen("Tokitsukaze.in","r",stdin);</td><td class="lineno">18</td></tr>
    <tr><td class="lineno">24</td><td class="left">        //freopen("Tokitsukaze.out","w",stdout);</td><td>&nbsp;</td><td class="right">        //freopen("Tokitsukaze.out","w",stdout);</td><td class="lineno">19</td></tr>
    <tr><td class="lineno">25</td><td class="lblock">        <span class='delete'>scanf("%d",&amp;n);build(root);</span></td><td>&nbsp;</td><td class="rblock">        <span class='insert'>scanf("%d",&amp;n);</span></td><td class="lineno">20</td></tr>
    <tr><td class="lineno">26</td><td class="lblock">        for(int <span class='delete'>i=1;i&lt;=n;i++)scanf("%d%d",&amp;d[i].x,&amp;d[i].y);</span></td><td>&nbsp;</td><td class="rblock">        for(int <span class='insert'>i=1;i&lt;=n;i++)scanf("%d%d",&amp;a[i].x,&amp;a[i].y),fz[++su]=a[i].x;</span></td><td class="lineno">21</td></tr>
    <tr><td class="lineno">27</td><td class="lblock"><span class='delete'>        sort(d+1,d+1+n,op);</span></td><td>&nbsp;</td><td class="rblock"><span class='insert'>        sort(a+1,a+n+1,bk);sort(fz+1,fz+su+1);</span></td><td class="lineno">22</td></tr>
    <tr><td class="lineno">28</td><td class="lblock"><span class='delete'>        int  k=0,s=-1;</span></td><td>&nbsp;</td><td class="rblock"><span class='insert'>        su=unique(fz+1,fz+su+1)-fz-1;</span></td><td class="lineno">23</td></tr>
    <tr><td class="lineno">&nbsp;</td><td class="lblock">&nbsp;</td><td>&nbsp;</td><td class="rblock"><span class='insert'>        for(int i=1;i&lt;=n;i++)a[i].x=find(a[i].x);</span></td><td class="lineno">24</td></tr>
    <tr><td class="lineno">&nbsp;</td><td class="lblock">&nbsp;</td><td>&nbsp;</td><td class="rblock"><span class='insert'>        LL ans=0;</span></td><td class="lineno">25</td></tr>
    <tr><td class="lineno">29</td><td class="left">        for(int i=1;i&lt;=n;i++){</td><td>&nbsp;</td><td class="right">        for(int i=1;i&lt;=n;i++){</td><td class="lineno">26</td></tr>
    <tr><td class="lineno">30</td><td class="lblock">                <span class='delete'>if(s!=d[i].x)k++;</span></td><td>&nbsp;</td><td class="rblock">                int <span class='insert'>l=query(a[i].x-1),r;</span></td><td class="lineno">27</td></tr>
    <tr><td class="lineno">31</td><td class="lblock"><span class='delete'>                s=d[i].x;d[i].x=k;</span></td><td>&nbsp;</td><td class="rblock"><span class='insert'>                if(i!=n&amp;&amp;a[i+1].y==a[i].y)r=query(a[i+1].x-1)-query(a[i].x);</span></td><td class="lineno">28</td></tr>
    <tr><td class="lineno">32</td><td class="lblock"><span class='delete'>                if(mp[k]==0)insert(root,k);</span></td><td>&nbsp;</td><td class="rblock"><span class='insert'>                else r=query(su)-query(a[i].x);</span></td><td class="lineno">29</td></tr>
    <tr><td class="lineno">33</td><td class="lblock"><span class='delete'>                mp[k]++;</span></td><td>&nbsp;</td><td class="rblock"><span class='insert'>                ans=ans+(LL)(l+1)*(LL)(r+1);</span></td><td class="lineno">30</td></tr>
    <tr><td class="lineno">34</td><td class="lblock"><span class='delete'>        }</span></td><td>&nbsp;</td><td class="rblock"><span class='insert'>                if(!used[a[i].x])used[a[i].x]=1,add(a[i].x);</span></td><td class="lineno">31</td></tr>
    <tr><td class="lineno">35</td><td class="lblock"><span class='delete'>        sort(d+1,d+1+n,bk);int l=1,r;</span></td><td>&nbsp;</td><td class="rblock">&nbsp;</td><td class="lineno">&nbsp;</td></tr>
    <tr><td class="lineno">36</td><td class="lblock"><span class='delete'>        while(l&lt;=n){</span></td><td>&nbsp;</td><td class="rblock">&nbsp;</td><td class="lineno">&nbsp;</td></tr>
    <tr><td class="lineno">37</td><td class="lblock"><span class='delete'>                r=l;</span></td><td>&nbsp;</td><td class="rblock">&nbsp;</td><td class="lineno">&nbsp;</td></tr>
    <tr><td class="lineno">38</td><td class="lblock"><span class='delete'>                while(d[r+1].y==d[l].y&amp;&amp;r&lt;n)r++;if(l!=r)sort(d+l,d+r+1,op);</span></td><td>&nbsp;</td><td class="rblock">&nbsp;</td><td class="lineno">&nbsp;</td></tr>
    <tr><td class="lineno">39</td><td class="lblock"><span class='delete'>                for(int i=l;i&lt;=r;i++)rk[i]=getrank(root,d[i].x)-1;</span></td><td>&nbsp;</td><td class="rblock">&nbsp;</td><td class="lineno">&nbsp;</td></tr>
    <tr><td class="lineno">40</td><td class="lblock">                int <span class='delete'>fz=getrank(root,inf)-1;rk[l-1]=-1;</span></td><td>&nbsp;</td><td class="rblock">&nbsp;</td><td class="lineno">&nbsp;</td></tr>
    <tr><td class="lineno">41</td><td class="lblock"><span class='delete'>                for(int i=l;i&lt;=r;i++)</span></td><td>&nbsp;</td><td class="rblock">&nbsp;</td><td class="lineno">&nbsp;</td></tr>
    <tr><td class="lineno">42</td><td class="lblock"><span class='delete'>                        ans+=(LL)(rk[i]-rk[i-1])*(LL)(fz-rk[i]);</span></td><td>&nbsp;</td><td class="rblock">&nbsp;</td><td class="lineno">&nbsp;</td></tr>
    <tr><td class="lineno">43</td><td class="lblock"><span class='delete'>                for(int i=l;i&lt;=r;i++){</span></td><td>&nbsp;</td><td class="rblock">&nbsp;</td><td class="lineno">&nbsp;</td></tr>
    <tr><td class="lineno">44</td><td class="lblock"><span class='delete'>                        mp[d[i].x]--;</span></td><td>&nbsp;</td><td class="rblock">&nbsp;</td><td class="lineno">&nbsp;</td></tr>
    <tr><td class="lineno">45</td><td class="lblock"><span class='delete'>                        if(mp[d[i].x]==0)remove(root,d[i].x);</span></td><td>&nbsp;</td><td class="rblock">&nbsp;</td><td class="lineno">&nbsp;</td></tr>
    <tr><td class="lineno">46</td><td class="lblock"><span class='delete'>                }</span></td><td>&nbsp;</td><td class="rblock">&nbsp;</td><td class="lineno">&nbsp;</td></tr>
    <tr><td class="lineno">47</td><td class="lblock"><span class='delete'>                l=r+1;</span></td><td>&nbsp;</td><td class="rblock">&nbsp;</td><td class="lineno">&nbsp;</td></tr>
    <tr><td class="lineno">48</td><td class="left">        }</td><td>&nbsp;</td><td class="right">        }</td><td class="lineno">32</td></tr>
    <tr><td class="lineno">49</td><td class="left">        printf("%lld\n",ans);</td><td>&nbsp;</td><td class="right">        printf("%lld\n",ans);</td><td class="lineno">33</td></tr>
    <tr><td class="lineno">50</td><td class="lblock">    return 0;</td><td>&nbsp;</td><td class="rblock">        return 0;</td><td class="lineno">34</td></tr>
    <tr><td class="lineno">51</td><td class="left">}</td><td>&nbsp;</td><td class="right">}</td><td class="lineno">35</td></tr>
    <tr><td class="lineno"></td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td class="lineno"></td></tr>
    <tr class="skip"><th colspan="5">&nbsp;End of changes. 1 change block.&nbsp;</th></tr>
<tr class="stats"><td></td><th><i>42 lines changed or deleted</i></th><th></th><th><i>26 lines changed or added</i></th><td></td></tr>    <tr><th colspan="5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th></tr>
  </table>
</body>
</html>
