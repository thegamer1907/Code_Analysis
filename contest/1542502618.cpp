/*
PPPPPPPPPPPPPP         OOOOOOOOOOOOOO      MMMMM                   MMMMM   PPPPPPPPPPPPPP      EEEEEEEEEEEEEEEE   RRRRRRRRRRRRRR      MMMMM                   MMMMM      AAAAAAAAAAA      NNNNN         NNNNN                   
P:::::::::::::P       O::::::::::::::O     M::::M                 M::::M   P:::::::::::::P     E::::::::::::::E   R:::::::::::::R     M::::M                 M::::M     A:::::::::::A     N::::N        N:::N
P:::PPPPPPPP:::P     O::::::::::::::::O    M:::::M               M:::::M   P:::PPPPPPPP:::P    E::EEEEEEEEEE::E   R:::RRRRRRRR:::R    M:::::M               M:::::M    A::AAAAAAAAA::A    N:::::N       N:::N
P:::P       P:::P   O::::::::::::::::::O   M::::::M             M::::::M   P:::P       P:::P   E::E        EEEE   R:::R       R:::R   M::::::M             M::::::M   A::A         A::A   N::::::N      N:::N
P:::P       P:::P   O:::OOOOOOOOOOOO:::O   M:::::::M           M:::::::M   P:::P       P:::P   E::E               R:::R       R:::R   M:::::::M           M:::::::M   A::A         A::A   N:::::::N     N:::N
P:::PPPPPPPP:::P    O:::O          O:::O   M:::M::::M         M::::M:::M   P:::PPPPPPPP:::P    E::E               R:::RRRRRRRR:::R    M:::M::::M         M::::M:::M   A::A         A::A   N:::N::::N    N:::N
P:::::::::::::P     O:::O          O:::O   M:::MM::::M       M::::MM:::M   P:::::::::::::P     E::EEEEEE          R:::::::::::::R     M:::MM::::M       M::::MM:::M   A::A         A::A   N:::NN::::N   N:::N
P::PPPPPPPPPPP      O:::O          O:::O   M:::M M::::M     M::::M M:::M   P::PPPPPPPPPPP      E:::::::E          R::RRR::RRRRRR      M:::M M::::M     M::::M M:::M   A::AAAAAAAAAAA::A   N:::N N::::N  N:::N
P::P                O:::O          O:::O   M:::M  M::::M   M::::M  M:::M   P::P                E:::::::E          R::R  R::R          M:::M  M::::M   M::::M  M:::M   A:::::::::::::::A   N:::N  N::::N N:::N
P::P                O:::O          O:::O   M:::M   M::::M M::::M   M:::M   P::P                E::EEEEEE          R::R   R::R         M:::M   M::::M M::::M   M:::M   A::AAAAAAAAAAA::A   N:::N   N::::NN:::N     
P::P                O:::O          O:::O   M:::M    M::::M::::M    M:::M   P::P                E::E               R::R    R::R        M:::M    M::::M::::M    M:::M   A::A         A::A   N:::N    N::::N:::N
P::P                O:::OOOOOOOOOOOO:::O   M:::M     M:::::::M     M:::M   P::P                E::E               R::R     R::R       M:::M     M:::::::M     M:::M   A::A         A::A   N:::N     N:::::::N
P::P                O::::::::::::::::::O   M:::M      M:::::M      M:::M   P::P                E::E        EEEE   R::R      R::R      M:::M      M:::::M      M:::M   A::A         A::A   N:::N      N::::::N
P::P                 O::::::::::::::::O    M:::M       M:::M       M:::M   P::P                E::EEEEEEEEEE::E   R::R       R::R     M:::M       M:::M       M:::M   A::A         A::A   N:::N       N:::::N
P::P                  O::::::::::::::O     M:::M        M:M        M:::M   P::P                E::::::::::::::E   R::R        R::R    M:::M        M:M        M:::M   A::A         A::A   N:::N        N::::N
PPPP                   OOOOOOOOOOOOOO      MMMMM         M         MMMMM   PPPP                EEEEEEEEEEEEEEEE   RRRR         RRRR   MMMMM         M         MMMMM   AAAA         AAAA   NNNNN         NNNNN

                         ..sSs$$$$$$b.
                       .$$$$$$$$$$$$$$$.
                    .$$$$$$$$$$$$$$$$$$$$$b.
                  .$$$$$$$$$$$$$$$$$$$$$$$$$
                 $$$$$$$$$$$$$$$$$S'   `$$$$
                 $$$$$$$$$$$$$$S'        $$$
                 $$$$$$$$$$$$$'          `$$.
                 `$$$$$$$$$$$$$           `$$$.
                   `$$$$$$$$$'       .s$$$ $$ $
                     $$$$$$$$$.sSs .s$$s"   s s
                      $$$$$$$$$$$$           $P
                      `$$$$$$$$$$$s          $
                        $$$$$$$$$$$.    ",
                        `$$$$$$$$$$sS$
        s$$$.            `$$$$$$$$$$$$.s"'   .$.
        $$$$$.              `$$$$$$$$$$.    .$$$Ss.s$s.
         $$$$$.              `$$$$$$$$$P   .$$$$$$$$$$$$.
         $$$$$$.               `$$$$$$$' .$$$$$$$$$$$$$$$$.
         `$$$$$$.                 $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$s.
           $$$$$$.                `$$$$$$$$$ $$$$$$$$$$$$$$$$$$$$$$$$s.
         .s$$$$$$$.                 `$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$.
         s  $$$$$$$.                .$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$.
         `$$$$$$$$$$.             .$$$' $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$.
          `$$$$$$$$$$.           s$'   $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$.
          $$$$$$$$$$$$e         $$$     `$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
        .' $$$$$$$$$$7         $$$$       `$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
       "   `$$$$$$$$7         $$$$$       .$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
      $$Ss..$$$$$$$7        $$$$$$$    .s$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
       $$$$$$$$$$$$        $$$$$$$$ .s$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
        $$$$$$$$$$$     .$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
      .$$$$$$$$$$$$$   .$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
      $$$$$$$$$$$$$$  .$$$$$$$$$$$ $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
      $$$$$$$$$$$$$$ .$$$$$$$$$$$' `$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
      $$$$$$$$$$$$$$ $$$$$$$$$$$$   `$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
      $$$$$$$$$$$$$$$$$$$$$$$$$$$    `$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
      `$$$$$$$$$$$$$$$$$$$$$$$$$$     `$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
       $$$$$$$$$$$$$$$$$$$$$$$$$$.     $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
       `$$$$$$$$$$$$$$$$$$$$$$$$$$     `$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
         $$$$$$$$$$$$$$$$$$$$$$$$$      $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
          $$$$$$$$$$$$$$$$$$$$$$$$      $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
           $$$$$$$$$$ $$$$$$$$$$$$      $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
            $$$$$$$$$$$$$$$$$$$$$$      $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
             $$$$$$$$$$$$$$$$$$$$'      $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
             `$$$$$$$$$$$$$$$$$$$       $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
              `$$$$$$$$$$$$$$$$$$.      $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
               `$$$$$$$$$$$$$$$$$$      $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
                 $$$$$$$$$$$$$$$$$.     $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
                  `$$$$$$$$$$$$$$$$     $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
                    $$$$$$$$$$$$$$$     `$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
                    $$$$$$$$$$$$$$$      $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
*/
#include <bits/stdc++.h>
#include <iostream>
#include <cstdio>
#include <algorithm>
#include <cstring>
#include <string>
#include <cctype>
#include <stack>
#include <queue>
#include <list>
#include <vector>
#include <map>
#include <sstream>
#include <cmath>
#include <Math.h>
#include <bitset>
#include <utility>
#include <set>
#include<conio.h>
#include<dos.h>
#include<windows.h>
#include <mmsystem.h>
#define mod 1000000007
using namespace std;
int n,k,T;
inline int gcd(int a,int b){if(b==0) return a; return gcd(b,a%b);}
inline int Pow(int x,int y)
{
  int ans=1,t=x;
  while(y>0){if(y&1) ans=1ll*ans*t%mod; t=1ll*t*t%mod; y=y>>1;}
  return ans;
}
inline int F(int q,int n)
{
  if(n<=0) return 0;
  if(q==1) return n;
  return 1ll*(Pow(q,n)-1)*Pow(q-1,mod-2)%mod;
}
//f^-1(g^-1(x))=[g(f(x))]^-1
inline int G(int q,int n)
{
  if(n<=0) return 0;
  if(q==1) return 1ll*n*(n+1)/2%mod;
  int v=Pow(q-1,mod-2);
  return (1ll*(Pow(q,n)-1)*v%mod*q%mod-n+mod)%mod*v%mod;
}
inline int work(int n,int k,int a[],int b[],int s1[],int s2[])
{
  if(n==1 && k==0){int X0=1ll*a[0]*Pow(mod+1-a[1],mod-2)%mod; return (1ll*s2[1]*X0+s2[0])%mod;}
  int _a[2],_b[2],_s1[2],_s2[2],p=n/k;
  int X=1ll*b[1]*Pow(a[1],p-1)%mod;
  int Y=(1ll*a[0]*b[1]%mod*F(a[1],p-1)+b[0])%mod;
  _a[1]=Pow(X,mod-2); _a[0]=(-1ll*Y*_a[1]%mod+mod)%mod;
  X=1ll*b[1]*Pow(a[1],p)%mod;
  Y=(1ll*a[0]*b[1]%mod*F(a[1],p)+b[0])%mod;
  _b[1]=Pow(X,mod-2), _b[0]=(-1ll*Y*_b[1]%mod+mod)%mod;
  _s1[1]=(s1[1]+1ll*s2[1]*a[1]%mod*F(a[1],p))%mod;
  _s2[1]=(s1[1]+1ll*s2[1]*a[1]%mod*F(a[1],p-1))%mod;
  _s1[0]=(s1[0]+1ll*s2[1]*a[0]%mod*G(a[1],p)+1ll*p*s2[0])%mod;
  _s2[0]=(s1[0]+1ll*s2[1]*a[0]%mod*G(a[1],p-1)+1ll*(p-1)*s2[0])%mod;
  return work(k,n%k,_a,_b,_s1,_s2);
}
int main(){
	cin>>T;
  while(T--)
  {
    cin>>n>>k;
    int d=gcd(n,k); n/=d; k/=d;
    int a[2]={1,1},b[2]={1,mod+1>>1},s1[2]={0,1},s2[2]={0,1};
    printf("%d\n",1ll*work(n,k,a,b,s1,s2)*Pow(n,mod-2)%mod);
  }
  return 0;


}
